{% load static %}
{% static "images" as baseUrl %}

<!DOCTYPE html>
<html lang="en">
<head>
    <title>Finan Girls Fashion Market</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Finan Girls Fashion Market - Trendy fashion for girls">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #a259ff; /* match previous blog page purple */
            --secondary-color: #f8f9fa;
            --accent-color: #6ec1e4; /* match previous blog page soft blue */
            --text-dark: #2c3e50;
            --text-light: #6c757d;
            --white: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background-color: #fafafa;
        }

        /* Header Styles */
        .navbar {
            background: linear-gradient(135deg, var(--primary-color), #f06292); /* purple to pink */
            box-shadow: var(--shadow);
            padding: 1rem 0;
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.8rem;
            color: var(--white) !important;
            text-decoration: none;
        }

        .navbar-nav .nav-link {
            color: var(--white) !important;
            font-weight: 500;
            margin: 0 0.5rem;
            transition: all 0.3s ease;
            border-radius: 20px;
            padding: 0.5rem 1rem;
        }

        .navbar-nav .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, var(--primary-color), #ff8fab);
            color: var(--white);
            padding: 4rem 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="10" r="0.5" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .hero-subtitle {
            font-size: 1.3rem;
            font-weight: 300;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        /* Features Section */
        .features-section {
            padding: 4rem 0;
            background-color: var(--white);
        }

        .feature-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 2rem;
            text-align: center;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            border: none;
            height: 100%;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .feature-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary-color), #ff8fab);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            color: var(--white);
            font-size: 2rem;
        }

        .feature-title {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 1rem;
        }

        .feature-text {
            color: var(--text-light);
            font-size: 0.95rem;
        }

        /* Products Section */
        .products-section {
            padding: 4rem 0;
            background-color: var(--secondary-color);
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 3rem;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            border-radius: 2px;
        }

        .product-card {
            background: var(--white);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            border: none;
            height: 100%;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .product-image {
            width: 90%;
            height: 365px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-body {
            padding: 1.5rem;
        }

        .product-title {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .product-description {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .product-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .btn-favorite {
            background: linear-gradient(135deg, var(--primary-color), #ff8fab);
            border: none;
            color: var(--white);
            padding: 0.5rem 1.5rem;
            border-radius: 25px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-favorite:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.4);
            color: var(--white);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .empty-icon {
            font-size: 4rem;
            color: var(--text-light);
            margin-bottom: 1rem;
        }

        /* Footer */
        .footer {
            background: linear-gradient(135deg, var(--text-dark), #34495e);
            color: var(--white);
            padding: 3rem 0 1rem;
        }

        .footer-content {
            text-align: center;
        }

        .footer-title {
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .footer-text {
            opacity: 0.8;
            font-size: 0.9rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .navbar-brand {
                font-size: 1.5rem;
            }
        }

        /* Animation Classes */
        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-in {
            animation: slideIn 0.8s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
    </style>
</head>
<body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-heart me-2"></i>Finan Girls Fashion Market
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'product_list' %}"><i class="fas fa-home me-1"></i>Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="#products"><i class="fas fa-shopping-bag me-1"></i>Products</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'blog_list' %}"><i class="fas fa-blog me-1"></i>Blog</a>
                    </li>
                    {% if user.is_authenticated %}
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'my_favorites' %}"><i class="fas fa-heart me-1"></i>My Favorites</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'profile' %}"><i class="fas fa-user me-1"></i>Profile</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'logout' %}"><i class="fas fa-sign-out-alt me-1"></i>Logout ({{ user.username }})</a>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'register' %}"><i class="fas fa-user-plus me-1"></i>Register</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'login' %}"><i class="fas fa-sign-in-alt me-1"></i>Login</a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="hero-content fade-in">
                <h1 class="hero-title"> Cute Outfits Ahead!!!  üëó üéÄ üíÉ </h1>
                <p class="hero-subtitle"> ·ãù·ã∞·àà·ã≠·ãé ·ãì·ã≠·äê·âµ ·ä≠·ã≥·äï ·ç£ ·å´·àõ ·äï ·â¶·à≠·à≥·äï ·ä£·â£·äì ·ã≠·à®·ä≠·â° </p>
                <a href="#products" class="btn btn-light btn-lg px-4 py-2">
                    <i class="fas fa-shopping-cart me-2"></i>Shop Now
                </a>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section">
        <div class="container">
            <h2 style="text-align: center;"> ·äì·â• ·çç·äì·äï ·àõ·ä•·ä®·àç ·ãï·ã≥·åã ·ä•·äï·âµ·àò·çÅ, ·ãù·à®·ä≠·â•·ãé ·åç·àç·åã·àé·âµ:</h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="feature-card slide-in">
                        <div class="feature-icon">
                            <i class="fas fa-tshirt"></i>
                        </div>
                        <h4 class="feature-title"> ·åç·ãö·ä¶·àù ·ãù·àì·àà·ãâ ·çã·àΩ·äì·âµ! </h4>
                        <p class="feature-text">Discover the latest trends in Finan girls fashion with our curated collection of stylish clothing and accessories.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card slide-in">
                        <div class="feature-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <h4 class="feature-title">Quality ·ãò·àà·ãé·àù</h4>
                        <p class="feature-text">Premium quality materials and craftsmanship ensure your fashion items last and look great.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <a href="{% url 'blog_list' %}" class="text-decoration-none">
                        <div class="feature-card slide-in">
                            <div class="feature-icon">
                                <i class="fas fa-blog"></i>
                            </div>
                            <h4 class="feature-title">·ä•·ãã·äì·ãä ·àì·â†·à¨·â≥·âµ</h4>
                            <p class="feature-text">Read our latest fashion tips, trends, and style guides to stay updated with the latest fashion news.</p>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </section>



    <!-- Our Shopping Gallery Section -->
    {% if shop_images %}
    <section class="shop-gallery my-5 text-center">
        <h2 class="section-title">Our Shopping Gallery</h2>
        <div class="row justify-content-center">
            {% for img in shop_images %}
            <div class="col-md-4 mb-4">
                <img src="{{ img.image.url }}" alt="{{ img.title }}" class="img-fluid rounded shadow-sm" style="max-height: 390px; width: 100%; max-width: 440px; margin: 0 auto; display: block;">
                {% if img.title %}
                <div class="mt-2 text-muted">{{ img.title }}</div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

      <!-- About Us Section (above products) -->
    <section class="about-section py-5" style="background: linear-gradient(135deg, #f3e8ff 60%, #e0f7fa 100%); border-radius: 0 0 18px 18px; margin-bottom: 2rem; width: 100%; box-shadow: 0 4px 24px rgba(162,89,255,0.08);">
        <div class="container-fluid px-0">
            <div class="row justify-content-center align-items-center g-0">
                <div class="col-12 text-center">
                    <div class="p-4">
                        <i class="fas fa-gem fa-4x mb-3" style="color:#a259ff;"></i>
                        <h4 class="fw-bold mb-3" style="color:#a259ff;">Who We Are</h4>
                        <h5 class="mb-3" style="color:#6ec1e4;">About Finan Girls Fashion Market</h5>
                        <p style="font-size:1.15rem; text-align:justify; color:#2c3e50; max-width: 800px; margin: 0 auto;">
                            <strong>Finan Girls Fashion Market</strong> is your go-to destination for trendy, high-quality girls' fashion in Tigray. We are passionate about empowering young women to express themselves through style. Our curated collection features the latest in clothes, shoes, and bags ‚Äî all handpicked for quality and flair.<br><br>
                             Even though we‚Äôre based in Mekelle, we proudly deliver to **anywhere in Tigray** ‚Äî bringing style right to your doorstep!<br><br>
                             Whether you're shopping for a special occasion or everyday chic, our team is here to help you shine. Thank you for supporting us!

                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section id="products" class="products-section">
        <div class="container">
            <h2 class="section-title" id="products">Our Products</h2>
            <!-- Search and Filter Bar -->
            <form method="get" action="#products" class="row g-3 align-items-center mb-4">
                <div class="col-md-6">
                    <input type="text" name="search" class="form-control" placeholder="Search products..." value="{{ search_query }}">
                </div>
                <div class="col-md-4">
                    <select name="category" class="form-select">
                        <option value="">All Categories</option>
                        {% for cat in categories %}
                            <option value="{{ cat.id }}" {% if selected_category == cat.id|stringformat:'s' %}selected{% endif %}>{{ cat.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-2">
                    <button type="submit" class="btn btn-primary w-100"><i class="fas fa-search me-1"></i>Search</button>
                </div>
            </form>
            
            {% if products %}
                <div class="row g-2"> <!-- Changed from g-4 to g-2 for smaller gap -->
                    {% for product in products %}
                    <div class="col-lg-4 col-md-6 mb-2"> <!-- Reduced margin-bottom -->
                        <div class="product-card fade-in" style="border-radius: 14px; box-shadow: 0 2px 10px rgba(0,0,0,0.07);">
                            {% if product.image %}
                                <a href="{% url 'product_detail' product.id %}"><img src="{{ product.image.url }}" alt="{{ product.name }}" class="product-image" style="cursor:pointer; border-radius: 12px;" loading="lazy"></a>
                            {% else %}
                                <div class="product-image d-flex align-items-center justify-content-center bg-light" style="border-radius: 12px;">
                                    <i class="fas fa-image fa-3x text-muted"></i>
                                </div>
                            {% endif %}
                            <div class="product-body">
                                <h5 class="product-title"><a href="{% url 'product_detail' product.id %}" style="text-decoration:none; color:inherit;">{{ product.name }}</a></h5>
                                <p class="text-muted mb-1">Category: {{ product.category.name }}</p>
                                <p class="product-description">{{ product.description|truncatewords:15 }}</p>
                                <div class="product-price">ETB {{ product.price }}</div>
                                <p class="mt-2 text-success" style="font-size: 1rem;">
                                    To order, call <a href="tel:+251985781426" style="color:inherit; text-decoration:underline;">+251985781426</a>.<br>
                                    Available in different colors and sizes.
                                </p>
                                {% if user.is_authenticated %}
                                    {% if product.is_favorite %}
                                        <button type="button" class="btn-favorite btn-danger favorite-toggle-btn" data-product-id="{{ product.id }}" data-action="remove">
                                            <i class="fas fa-heart-broken me-1"></i>Unfavorite
                                        </button>
                                    {% else %}
                                        <button type="button" class="btn-favorite favorite-toggle-btn" data-product-id="{{ product.id }}" data-action="add">
                                            <i class="fas fa-heart me-1"></i>Add to Favorites
                                        </button>
                                    {% endif %}
                                {% else %}
                                    <a href="{% url 'login' %}" class="btn-favorite">
                                        <i class="fas fa-sign-in-alt me-1"></i>Login to Favorite
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-shopping-bag"></i>
                    </div>
                    <h4>No Products Available</h4>
                    <p class="text-muted">Please add some products through the admin panel to get started.</p>
                    <a href="/admin/" class="btn btn-primary">
                        <i class="fas fa-cog me-1"></i>Go to Admin
                    </a>
                </div>
            {% endif %}
        </div>
    </section>

    <!-- Customer Opinions Section (replaces Contact & About Us) -->
    <section class="opinions-section py-5" style="background: linear-gradient(135deg, #e0f7fa 60%, #f3e8ff 100%); border-radius: 18px; box-shadow: 0 4px 24px rgba(162,89,255,0.08); width: 100%; margin: 3rem 0; min-height: 420px;">
        <div class="container-fluid px-0">
            <h2 class="section-title mb-4 text-center">What Our Customers Say(·ãì·àõ·ãä·àç·äì ·ãù·â†·àç·ãé)</h2>
            <div class="row g-4 justify-content-center">
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm border-0">
                        <div class="card-body">
                            <i class="fas fa-quote-left fa-2x mb-3" style="color:#a259ff;"></i>
                            <p class="card-text"> "·â•·å£·ãï·àö ·ã∞·àµ ·àç·â•·àç ·å•·à´·âµ ·ãò·àà·ãé ·â¶·à≠·à≥ ·ãà·à≤·ã∞ ·äî·à®·ç£ ·åã·àà·ã≠ ·â•·å£·ãï·àö ·ä•·ã´ ·çà·âµ·ã´·â∂, thank you so much."</p>
                            <div class="d-flex align-items-center mt-3">
                                <img src="https://th.bing.com/th/id/OIP.jq6dzhZBeLyUVdo9eOlzQgHaJQ?w=135&h=180&c=7&r=0&o=5&dpr=2&pid=1.7" alt="Customer" class="rounded-circle me-2" width="40" height="40">
                                <span class="fw-bold">Sara Mehari.</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm border-0">
                        <div class="card-body">
                            <i class="fas fa-quote-left fa-2x mb-3" style="color:#a259ff;"></i>
                            <p class="card-text">"·ãù·åà·à≠·àù ·àò·àµ·â∞·äï·åç·ãµ·âµ·äï ·çà·å£·äï ·ãù·äÆ·äê delivery ·ä£·àà·ãé·àù, ·ãò·àç·ä£·ä≠·ãé ·å´·àõ ·ä´·â• ·ãù·àì·à∞·â•·ä≠·ãé ·â•·àã·ãï·àä ·ä•·ã© ·å∞·äí·àï·äí, ·ã®·âê·äï·ã®·àà·ã≠ ·çç·äì·äï ·àõ·ä•·ä®·àç ·ãï·ã≥·åã·ç¢"</p>
                            <div class="d-flex align-items-center mt-3">
                                
                                <span class="fw-bold">Liya Tsegay.</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm border-0">
                        <div class="card-body">
                            <i class="fas fa-quote-left fa-2x mb-3" style="color:#a259ff;"></i>
                            <p class="card-text">"·â•·ãì·ã≠·äê·â∂·àù ·çç·àç·ã≠ ·ãù·â†·àâ·äï ·ã∞·à®·åÖ·ä¶·àù ·ãù·àì·àà·ãâ ·äï·â•·àà·âµ ·àµ·àà·ãù·àï·ãô, ·àù·à≠·å´·ä©·àù ·çç·äì·äï ·àõ·ä•·ä®·àç ·ãï·ã≥·åã ·ã≠·ä©·äï ·ã≠·â•·àç·ç¢"</p>
                            <div class="d-flex align-items-center mt-3">
                                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR7zbeobZlBSuaJJzqmNeofXZ10VajA0a8uVQ&s" alt="Customer" class="rounded-circle me-2" width="40" height="40">
                                <span class="fw-bold">Mekdes Abebe.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row align-items-center py-4">
                <div class="col-md-6 text-md-start text-center mb-3 mb-md-0">
                    <h2 class="footer-title mb-2">Contact Us</h2>
                    <p class="footer-text mb-1"><i class="fas fa-map-marker-alt me-2"></i> ·âê·ã≥·àõ·ã≠ ·ãà·ã´·äê, ·àò·âê·àà, ·âµ·åç·à´·ã≠</p>
                    <p class="footer-text mb-1"> <img src="{% static 'images/miki.jpg' %}" alt="Owner" class="rounded-circle me-2" width="30" height="25"> Michale Gebreslassie</p>
                    <p class="footer-text mb-1"><i class="fas fa-envelope me-2"></i> mikigere@gmail.com</p>
                    <p class="footer-text mb-1"><i class="fas fa-phone me-2"></i> +251985781426 </p>
                    <p class="footer-text mb-1"><i class="fab fa-telegram me-2"></i> <a href="https://t.me/finangirlsfashion" class="text-white" target="_blank">@finangirlsfashion</a></p>
                </div>
                <div class="col-md-6 text-md-end text-center">
                    <div class="mt-3 mt-md-0">
                        <a href="#" class="text-white me-3"><i class="fab fa-facebook-f fa-lg"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-instagram fa-lg"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-twitter fa-lg"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-pinterest fa-lg"></i></a>
                    </div>
                    <p class="footer-text mt-3 mb-0">¬© 2025 Finan Girls Fashion Market </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script>
        // Add smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add animation on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Observe all product cards
        document.querySelectorAll('.product-card').forEach(card => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            observer.observe(card);
        });

        // AJAX favorite/unfavorite logic
        document.querySelectorAll('.favorite-toggle-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const productId = this.getAttribute('data-product-id');
                const action = this.getAttribute('data-action');
                const url = action === 'add'
                    ? `/users/add_favorite/${productId}/`
                    : `/users/remove_favorite/${productId}/`;
                fetch(url, {
                    method: 'POST',
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest',
                        'X-CSRFToken': getCookie('csrftoken'),
                    },
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        if (data.favorited) {
                            this.setAttribute('data-action', 'remove');
                            this.classList.add('btn-danger');
                            this.innerHTML = '<i class="fas fa-heart-broken me-1"></i>Unfavorite';
                        } else {
                            this.setAttribute('data-action', 'add');
                            this.classList.remove('btn-danger');
                            this.innerHTML = '<i class="fas fa-heart me-1"></i>Add to Favorites';
                        }
                    }
                });
            });
        });

        // Helper to get CSRF token
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
    </script>

    <!-- Image Modal -->
    <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="imageModalLabel"></h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body text-center">
            <img id="modalImage" src="" alt="" class="img-fluid rounded" style="max-height:70vh;">
          </div>
        </div>
      </div>
    </div>
    <script>
    function showImageModal(url, name) {
        document.getElementById('modalImage').src = url;
        document.getElementById('imageModalLabel').textContent = name;
    }
    </script>
</body>
</html>

